# 書籍情報取得API選定

## 1. 検討したAPI

### 1.1 Open Library API
- **URL**: https://openlibrary.org/developers/api
- **特徴**:
  - ✅ 無料で利用可能
  - ✅ APIキー不要（登録不要）
  - ✅ 国際的な書籍データベース（2000万冊以上）
  - ✅ タイトルとISBNの両方で検索可能
  - ✅ カバー画像URLを提供
  - ✅ 著者、出版社、出版日、ページ数などの詳細情報を提供
  - ✅ RESTful APIで使いやすい
  - ⚠️ レート制限あり（1秒あたり100リクエスト）

### 1.2 Google Books API
- **URL**: https://developers.google.com/books
- **特徴**:
  - ✅ 無料で利用可能（1日あたり1,000リクエストまで）
  - ⚠️ APIキーが必要（Google Cloud Platformの登録が必要）
  - ✅ 国際的な書籍データベース
  - ✅ タイトルとISBNの両方で検索可能
  - ✅ カバー画像URLを提供
  - ✅ 詳細な書籍情報を提供
  - ⚠️ レート制限あり（1日あたり1,000リクエスト）

### 1.3 OpenBD API
- **URL**: https://openbd.jp/
- **特徴**:
  - ✅ 無料で利用可能
  - ✅ APIキー不要
  - ⚠️ 日本の書籍中心（ISBN検索のみ）
  - ✅ 書影（カバー画像）を提供
  - ⚠️ タイトル検索は非対応（ISBNのみ）

### 1.4 Cinii Books API
- **URL**: https://ci.nii.ac.jp/books/opensearch/api
- **特徴**:
  - ✅ 無料で利用可能
  - ✅ APIキー不要
  - ⚠️ 日本の書籍中心（大学図書館の所蔵書籍）
  - ✅ タイトルとISBNの両方で検索可能
  - ⚠️ カバー画像は提供されない場合が多い

---

## 2. 選定結果

### 推奨: **Open Library API**

**選定理由：**

1. **APIキー不要**
   - 登録不要で即座に利用開始可能
   - 開発初期から簡単に実装できる

2. **国際的な書籍データベース**
   - 日本の書籍だけでなく、世界中の書籍に対応
   - 2000万冊以上の書籍情報を提供

3. **検索機能**
   - タイトルとISBNの両方で検索可能
   - 複数の候補を返すため、ユーザーが選択可能

4. **情報の充実**
   - 著者、出版社、出版日、ページ数、カバー画像など必要な情報を提供
   - 説明文も取得可能

5. **使いやすさ**
   - RESTful APIで実装が簡単
   - JSON形式でレスポンスを返す

**補完API（オプション）：**

- **OpenBD API**: 日本の書籍でOpen Library APIに情報がない場合の補完として使用
- **Google Books API**: より詳細な情報が必要な場合や、Open Library APIで見つからない場合の補完として使用

---

## 3. API利用方針

1. **プライマリAPI**: Open Library API
   - タイトルまたはISBNで検索
   - 複数候補がある場合はユーザーに選択を提示

2. **フォールバック**: 
   - Open Library APIで情報が取得できない場合、Google Books APIを試行（オプション）
   - それでも取得できない場合は、手動入力フォームを表示

3. **エラーハンドリング**:
   - APIが利用できない場合のエラーメッセージ表示
   - タイムアウト処理
   - レート制限に達した場合の対応

4. **キャッシュ**:
   - 同じISBN/タイトルで検索した結果を一時的にキャッシュ（任意）
   - サーバー側でキャッシュすることで、API呼び出し回数を削減

---

## 4. API実装例

### 4.1 Open Library API の使用例

#### ISBN検索
```
GET https://openlibrary.org/api/books?bibkeys=ISBN:9784774163666&format=json&jscmd=data
```

#### タイトル検索
```
GET https://openlibrary.org/search.json?title=タイトル
```

### 4.2 レスポンス例

#### ISBN検索のレスポンス
```json
{
  "ISBN:9784774163666": {
    "title": "書籍タイトル",
    "authors": [{"name": "著者名"}],
    "publishers": [{"name": "出版社"}],
    "publish_date": "2023-01-01",
    "number_of_pages": 300,
    "cover": {
      "large": "https://covers.openlibrary.org/b/id/123456-L.jpg"
    }
  }
}
```

#### タイトル検索のレスポンス
```json
{
  "numFound": 10,
  "docs": [
    {
      "title": "書籍タイトル",
      "author_name": ["著者名"],
      "publisher": ["出版社"],
      "publish_date": ["2023"],
      "number_of_pages_median": 300,
      "cover_i": 123456,
      "isbn": ["9784774163666"]
    }
  ]
}
```

### 4.3 実装時の注意点

1. **ISBNの形式**
   - ISBN-10とISBN-13の両方に対応
   - ハイフンの有無を考慮

2. **タイトル検索**
   - 部分一致でも検索可能
   - 複数候補がある場合は、ユーザーに選択を提示

3. **カバー画像**
   - `cover_i` から画像URLを生成: `https://covers.openlibrary.org/b/id/{cover_i}-L.jpg`
   - サイズ: S (Small), M (Medium), L (Large)

4. **エラーハンドリング**
   - APIが利用できない場合（503エラーなど）
   - タイムアウト（5秒程度）
   - レート制限（429エラー）

---

## 5. 比較表

| 項目 | Open Library API | Google Books API | OpenBD API | Cinii Books API |
|------|----------------|------------------|------------|-----------------|
| **費用** | 無料 | 無料 | 無料 | 無料 |
| **APIキー** | 不要 | 必要 | 不要 | 不要 |
| **書籍数** | 2000万冊以上 | 大規模 | 日本の書籍中心 | 日本の書籍中心 |
| **タイトル検索** | ✅ | ✅ | ❌ | ✅ |
| **ISBN検索** | ✅ | ✅ | ✅ | ✅ |
| **カバー画像** | ✅ | ✅ | ✅ | ⚠️ |
| **レート制限** | 1秒/100リクエスト | 1日/1000リクエスト | 不明 | 不明 |
| **国際対応** | ✅ | ✅ | ❌ | ❌ |

---

## 6. 結論

この読書管理アプリには**Open Library APIを推奨**します。

**主な理由：**
- ✅ APIキー不要で即座に利用開始可能
- ✅ 国際的な書籍データベースで幅広い書籍に対応
- ✅ タイトルとISBNの両方で検索可能
- ✅ 必要な情報（著者、出版社、ページ数、カバー画像など）を提供
- ✅ RESTful APIで実装が簡単

**補完APIとして：**
- 日本の書籍で情報が見つからない場合: OpenBD API
- より詳細な情報が必要な場合: Google Books API


